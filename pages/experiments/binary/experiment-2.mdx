import loss_batch from '../../../data/experiment-2/batch-exp-2.png';
import acc from '../../../data/experiment-2/acc-exp-2.png';
import loss from '../../../data/experiment-2/loss-exp-2.png';
import classs from '../../../data/experiment-2/classes=exp2-png.png';
import conv from '../../../data/experiment-2/conv-exp2.png';
import linear_histogram from '../../../data/experiment-2/linear-exp2.png';
import cf from '../../../data/experiment-2/cf-exp2.png';
import Image from "next/image";


# Experiment 2
![](https://img.shields.io/static/v1?label=Tensorboard_log&message=Jan26_01-48-31&color=bbbbbb)

Binary classification with VGGish model architecture.
Logs and metrics have been implemented with tensorboard and pytorch.



## Parameters
### basic setting parameters
clip_length: 1.0 # [sec]

### preprocessing parameters
sample_rate: `22050`

hop_length: `512`

n_fft: `1024`

n_mels: `64`


### Training parameters

number of audio samples: `22050`

learning rate: `0.001`

batch size: `20`

number of epochs: `30`

number of samples: `60`

balanced dataset: `True`

random clip cut: `False`

## Classes
### Labels

` grime `
` jazz `
### Class distribution

| Class        | Class ID |    Samples |
| :------------ | :---------: | ----------: |
| grime        |    0    | 30 |
| jazz     |    1     |    30 |

## Results
### Logs
````
...
Epoch: [30/30] started...
Num samples: 22050
Epoch: 30 [30/60 (50%)] Loss: 0.407079 Accuracy: 90.0%
Epoch: 30 [60/60 (100%)] Loss: 0.719881 Accuracy: 56.666666666666664%
[Class: grime] accuracy: 76.7 %
[Class: jazz ] accuracy: 70.0 %
Epoch: [30/30] Loss: 0.563480 Accuracy: 73.33333333333333%
[[=============================================================================================]]
Training is done!
````

## Metrics
### Cross entropy

<Image src={loss} width={900} height={400}/>

### Accuracy
<Image src={acc} width={900} height={400}/>

### Loss/Accuracy per batch
<Image src={loss_batch} width={900} height={400}/>

### Accuracy per class
<Image src={classs} width={900} height={400}/>

![](https://img.shields.io/static/v1?label=class&message=grime&color=ff7043)
![](https://img.shields.io/static/v1?label=class&message=jazz&color=0077bb)

### Conv4 Layer
<Image src={conv} width={900} height={400}/>

---

#### Conv4 parameters

```python
        self.conv4 = nn.Sequential(
            nn.Conv2d(
                in_channels=64,
                out_channels=128,
                kernel_size=3,
                stride=1,
                padding=2
            ),
            nn.ReLU(),
            nn.MaxPool2d(kernel_size=2)
        )
```
---

### Linear layer

<Image src={linear_histogram} width={900} height={400}/>

### Confusion Matrix
<Image src={cf} width={900} height={400}/>

